---
title: "Data Exploratory Analysis"
author: "AAA"
date: "20 de diciembre de 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Course Description

When your dataset is represented as a table or a database, it's difficult to observe much about it beyond its size and the types of variables it contains. In this course, you'll learn how to use graphical and numerical techniques to begin uncovering the structure of your data. Which variables suggest interesting relationships? Which observations are unusual? By the end of the course, you'll be able to answer these questions and more, while generating graphics that are both insightful and beautiful.

1

## Exploring Categorical Data

In this chapter, you will learn how to create graphical and numerical summaries of two categorical variables.


### Contingency table review

In this chapter you'll continue working with the comics dataset introduced in the video. This is a collection of characteristics on all of the superheroes created by Marvel and DC comics in the last 80 years.

Let's start by creating a contingency table, which is a useful way to represent the total counts of observations that fall into each combination of the levels of categorical variables.

### INSTRUCTIONS

The dataset has been loaded into your workspace as comics.

Type the name of the dataset to look at the rows and columns of the dataset.
View the levels() that the align variable can take.
View the levels() that the gender variable can take.
Create a contingency table of the same two variables.

```{r}
#pre exercise code


url <- "http://s3.amazonaws.com/assets.datacamp.com/production/course_1796/datasets/comics.csv"

#download.file(url, "comics.csv")
#install.packages("dplyr")
#install.packages("ggplot2")

#dataframe
comics <- read.csv("comics.csv", stringsAsFactors = TRUE)
```

```{r}
# Print the first rows of the data
comics

# Check levels of align
levels(comics$align)

# Check the levels of gender
levels(comics$gender)

# Create a 2-way contingency table
tab <- table(comics$align, comics$gender)

tab

```

### Dropping levels

The contingency table from the last exercise revealed that there are some levels that have very low counts. To simplify the analysis, it often helps to drop such levels.

In R, this requires two steps: first filtering out any rows with the levels that have very low counts, then removing these levels from the factor variable with droplevels(). This is because the droplevels() function would keep levels that have just 1 or 2 counts; it only drops levels that don't exist in a dataset.

### INSTRUCTIONS

The contingency table from the last exercise is available in your workspace as tab.

Load the dplyr package.
Print tab to find out which level of align has the fewest total entries.
Use filter() to filter out all rows of comics with that level, then drop the unused level with droplevels(). Save the simplifed dataset over the old one as comics.

```{r}
# Load dplyr
library(dplyr)

# Print tab
tab

# Remove align level
comics <- comics %>%
  filter(align != "Reformed Criminals") %>%
  droplevels()

table(comics$align, comics$gender)

```

### Side-by-side barcharts

While a contingency table represents the counts numerically, it's often more useful to represent them graphically.

Here you'll construct two side-by-side barcharts of the comics data. This shows that there can often be two or more options for presenting the same data. Passing the argument position = "dodge" to geom_bar() says that you want a side-by-side (i.e. not stacked) barchart.

### INSTRUCTIONS

Load the ggplot2 package.
Create a side-by-side barchart with align on the x-axis and gender as the fill aesthetic.
Create another side-by-side barchart with gender on the x-axis and align as the fill aesthetic. Rotate the axis labels 90 degrees to help readability.

```{r}
# Load ggplot2
library("ggplot2")

# Create side-by-side barchart of gender by alignment
ggplot(comics, aes(x = align, fill = gender)) + 
  geom_bar(position = "dodge")

# Create side-by-side barchart of alignment by gender
ggplot(comics, aes(x = gender, fill = align)) + 
  geom_bar(position = "dodge") +
  theme(axis.text.x = element_text(angle = 90))

```

### Counts vs. proportions (2)

Bar charts can tell dramatically different stories depending on whether they represent counts or proportions and, if proportions, what the proportions are conditioned on. To demonstrate this difference, you'll construct two barcharts in this exercise: one of counts and one of proportions.

### INSTRUCTIONS

Create a stacked barchart of gender counts with align on the x-axis.
Create a stacked barchart of gender proportions with align on the x-axis by setting the position argument to geom_bar() equal to "fill".

```{r}
# Plot of gender by align
ggplot(comics, aes(x = align, fill = gender)) +
  geom_bar()
  
# Plot proportion of gender, conditional on align
ggplot(comics, aes(x = align, fill = gender)) + 
  geom_bar(position = "fill") +
  ylab("proportion")

```

### Marginal barchart

If you are interested in the distribution of alignment of all superheroes, it makes sense to construct a barchart for just that single variable.

You can improve the interpretability of the plot, though, by implementing some sensible ordering. Superheroes that are "Neutral" show an alignment between "Good" and "Bad", so it makes sense to put that bar in the middle.

### INSTRUCTIONS

Reorder the levels of align using the factor() function so that printing them reads "Bad", "Neutral", then "Good".
Create a barchart of counts of the align variable.

```{r}
# Change the order of the levels in align
comics$align <- factor(comics$align, 
                       levels = c("Bad", "Neutral", "Good"))

# Create plot of align
ggplot(comics, aes(x = align)) + 
  geom_bar()
```

### Conditional barchart

Now, if you want to break down the distribution of alignment based on gender, you're looking for conditional distributions.

You could make these by creating multiple filtered datasets (one for each gender) or by faceting the plot of alignment based on gender. As a point of comparison, we've provided your plot of the marginal distribution of alignment from the last exercise.

### INSTRUCTIONS

Create a barchart of align faceted by gender.

```{r}
# Plot of alignment broken down by gender
ggplot(comics, aes(x = align)) + 
  geom_bar() +
  facet_wrap(~ gender)

```

### Improve piechart

The piechart is a very common way to represent the distribution of a single categorical variable, but they can be more difficult to interpret than barcharts.

This is a piechart of a dataset called pies that contains the favorite pie flavors of 98 people. Improve the representation of these data by constructing a barchart that is ordered in descending order of count.

### INSTRUCTIONS

Use the code provided to reorder the levels of flavor so that they're in descending order by count.
Create a barchart of flavor and orient the labels vertically so that they're easier to read. The default coloring may look drab by comparison, so change the fill of the bars to "chartreuse".

```{r}
#pre_code

flavor <- rep(c("cherry", "key lime", "boston creme", "strawberry", 
                "blueberry", "apple", "pumpkin"),
              c(13, 16, 15, 11, 14, 17, 12))
pies <- data.frame(flavor = as.factor(flavor))
cnt <- count(pies, flavor)

ggplot(cnt, aes(x = "", y = n, fill = flavor)) +
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start = pi / 3) +
  xlab("") +
  ylab("") +
  theme(panel.grid.minor = element_blank(),
  panel.grid.major = element_blank(),
  axis.ticks = element_blank(),
  axis.text = element_blank())

```

```{r}
# Put levels of flavor in decending order
lev <- c("apple", "key lime", "boston creme", "blueberry", "cherry", "pumpkin", "strawberry")
pies$flavor <- factor(pies$flavor, levels = lev)

# Create barchart of flavor
ggplot(pies, aes(x = flavor)) + 
  geom_bar(fill = "chartreuse") + 
  theme(axis.text.x = element_text(angle = 90))
```

## Exploring Numerical Data

In this chapter, you will learn how to graphically summarize numerical data.

### Faceted histogram

In this chapter, you'll be working with the cars dataset, which records characteristics on all of the new models of cars for sale in the US in a certain year. You will investigate the distribution of mileage across a categorial variable, but before you get there, you'll want to familiarize yourself with the dataset.

### INSTRUCTIONS

The cars dataset has been loaded in your workspace.

Load the ggplot2 package.
View the size of the data and the variable types using str().
Plot a histogram of city_mpg faceted by suv, a logical variable indicating whether the car is an SUV or not.


```{r}
library(datasets)
data("mtcars")

# Load package
library("ggplot2")

# Learn data structure
str(cars)

# Create faceted histogram
ggplot(cars, aes(x = city_mpg)) +
  geom_histogram() +
  facet_wrap(~ suv)

```

```{r}
url <- "http://s3.amazonaws.com/assets.datacamp.com/production/course_1796/datasets/cars04.csv"
download.file(url, "cars04.csv")

cars <- read.csv("cars04.csv")
```

### Boxplots and density plots

The mileage of a car tends to be associated with the size of its engine (as measured by the number of cylinders). To explore the relationship between these two variables, you could stick to using histograms, but in this exercise you'll try your hand at two alternatives: the box plot and the density plot.

### INSTRUCTIONS

A quick look at unique(cars$ncyl) shows that there are more possible levels of ncyl than you might think. Here, restrict your attention to the most common levels.

Filter cars to include only cars with 4, 6, or 8 cylinders and save the result as common_cyl. The %in% operator may prove useful here.
Create side-by-side box plots of city_mpg separated out by ncyl.
Create overlaid density plots of city_mpg colored by ncyl.

```{r}
# Filter cars with 4, 6, 8 cylinders
common_cyl <- filter(cars, cars$ncyl %in% c(4,6,8))

# Create box plots of city mpg by ncyl
ggplot(common_cyl, aes(x = as.factor(ncyl), y = city_mpg)) +
  geom_boxplot()

# Create overlaid density plots for same data
ggplot(common_cyl, aes(x = city_mpg, fill = as.factor(ncyl))) +
  geom_density(alpha = .3)
```



## Numerical Summaries

Now that we've looked at exploring categorical and numerical data, you'll learn some useful statistics for describing distributions of data.


```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```




Case Study

Apply what you've learned to explore and summarize a real world dataset in this case study of email spam.

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```





